<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Kalkulator BlackRock</title>
  <style>
    :root {
      --bg: #1f1f1f;
      --fg: #00ffe7;
      --button: #333;
      --button-hover: #444;
      --display-bg: #2a2a2a;
      --theme-button: #00b4d8;
      --equal-button: #00b4d8;
      --equal-text: black;
    }

    body.light {
      --bg: #f4f4f4;
      --fg: #222;
      --button: #ddd;
      --button-hover: #ccc;
      --display-bg: #fff;
      --theme-button: #0077cc;
      --equal-button: #0077cc;
      --equal-text: white;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--fg);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      transition: background 0.3s, color 0.3s;
    }

    .calculator {
      background: var(--display-bg);
      border-radius: 15px;
      box-shadow: 0 0 25px rgba(0,255,231,0.15);
      padding: 20px;
      width: 340px;
      transition: 0.3s;
    }

    .display {
      width: 100%;
      font-size: 2em;
      height: 60px;
      text-align: right;
      margin-bottom: 10px;
      border: none;
      background: var(--display-bg);
      color: var(--fg);
      padding: 10px;
      border-radius: 8px;
    }

    .buttons {
      display: grid;
      grid-template-columns: repeat(4, 70px);
      grid-gap: 10px;
    }

    button {
      height: 60px;
      font-size: 18px;
      border: none;
      border-radius: 10px;
      background: var(--button);
      color: var(--fg);
      cursor: pointer;
      transition: 0.2s;
      transform: scale(1);
    }

    button:hover {
      background: var(--button-hover);
      transform: scale(1.05);
    }

    .equals {
      background-color: var(--equal-button);
      color: var(--equal-text);
    }

    .theme-toggle {
      background: var(--theme-button);
      color: white;
      margin-bottom: 10px;
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      border: none;
      width: 100%;
    }

    .history {
      margin-top: 15px;
      background: var(--display-bg);
      padding: 10px;
      border-radius: 8px;
      max-height: 120px;
      overflow-y: auto;
      font-size: 14px;
    }
  </style>
</head>
<body>

<div class="calculator">
  <button class="theme-toggle" onclick="toggleTheme()">üîÅ Ganti Tema</button>
  <input type="text" class="display" id="display" disabled>
  <div class="buttons">
    <button onclick="clearMemory()">MC</button>
    <button onclick="recallMemory()">MR</button>
    <button onclick="addMemory()">M+</button>
    <button onclick="subtractMemory()">M-</button>

    <button onclick="saveMemory()">MS</button>
    <button onclick="noop()">Mv</button>
    <button onclick="clearEntry()">CE</button>
    <button onclick="clearDisplay()">C</button>

    <button onclick="backspace()">‚å´</button>
    <button onclick="percent()">%</button>
    <button onclick="inverse()">1/x</button>
    <button onclick="square()">x¬≤</button>

    <button onclick="sqrt()">‚àö</button>
    <button onclick="inputValue('/')">√∑</button>
    <button onclick="inputValue('*')">√ó</button>
    <button onclick="inputValue('-')">‚àí</button>

    <button onclick="inputValue('7')">7</button>
    <button onclick="inputValue('8')">8</button>
    <button onclick="inputValue('9')">9</button>
    <button onclick="inputValue('+')">+</button>

    <button onclick="inputValue('4')">4</button>
    <button onclick="inputValue('5')">5</button>
    <button onclick="inputValue('6')">6</button>
    <button onclick="calculate()" class="equals">=</button>

    <button onclick="inputValue('1')">1</button>
    <button onclick="inputValue('2')">2</button>
    <button onclick="inputValue('3')">3</button>
    <button onclick="toggleSign()">+/‚àí</button>

    <div></div>
    <button onclick="inputValue('0')">0</button>
    <button onclick="inputValue('.')">.</button>
    <div></div>
  </div>
  <div class="history" id="history"></div>
</div>

<audio id="click-sound" src="https://www.soundjay.com/buttons/sounds/button-09.mp3" preload="auto"></audio>

<script>
  const display = document.getElementById('display');
  const historyEl = document.getElementById('history');
  const clickSound = document.getElementById('click-sound');
  let memory = 0;

  function inputValue(val) {
    playClick();
    display.value += val;
  }

  function clearDisplay() {
    playClick();
    display.value = '';
  }

  function clearEntry() {
    playClick();
    display.value = '';
  }

  function backspace() {
    playClick();
    display.value = display.value.slice(0, -1);
  }

  function calculate() {
    playClick();
    try {
      const result = eval(display.value);
      addToHistory(`${display.value} = ${result}`);
      display.value = result;
    } catch {
      display.value = 'Error';
    }
  }

  function percent() {
    playClick();
    display.value = eval(display.value) / 100;
  }

  function inverse() {
    playClick();
    display.value = 1 / eval(display.value);
  }

  function square() {
    playClick();
    display.value = Math.pow(eval(display.value), 2);
  }

  function sqrt() {
    playClick();
    display.value = Math.sqrt(eval(display.value));
  }

  function toggleSign() {
    playClick();
    display.value = eval(display.value) * -1;
  }

  function clearMemory() { memory = 0; playClick(); }
  function recallMemory() { playClick(); display.value += memory; }
  function addMemory() { playClick(); memory += eval(display.value); }
  function subtractMemory() { playClick(); memory -= eval(display.value); }
  function saveMemory() { playClick(); memory = eval(display.value); }
  function noop() { playClick(); alert("Fungsi Mv belum diimplementasikan."); }

  function addToHistory(entry) {
    const existing = JSON.parse(localStorage.getItem('calc-history') || '[]');
    existing.push(entry);
    localStorage.setItem('calc-history', JSON.stringify(existing.slice(-10))); // max 10 history
    renderHistory();
  }

  function renderHistory() {
    const entries = JSON.parse(localStorage.getItem('calc-history') || '[]');
    historyEl.innerHTML = entries.map(e => `<div>${e}</div>`).join('');
  }

  function playClick() {
    clickSound.currentTime = 0;
    clickSound.play();
  }

  function toggleTheme() {
    document.body.classList.toggle('light');
    localStorage.setItem('calc-theme', document.body.classList.contains('light') ? 'light' : 'dark');
  }

  function loadTheme() {
    const savedTheme = localStorage.getItem('calc-theme');
    if (savedTheme === 'light') {
      document.body.classList.add('light');
    }
  }

  // Keyboard input
  document.addEventListener('keydown', e => {
    if (!isNaN(e.key) || ['+', '-', '*', '/', '.', '(', ')'].includes(e.key)) inputValue(e.key);
    if (e.key === 'Enter') calculate();
    if (e.key === 'Backspace') backspace();
    if (e.key === 'Escape') clearDisplay();
  });

  // Initial load
  renderHistory();
  loadTheme();
</script>

</body>
</html>
